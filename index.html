
<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Marketing Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            lightGlass: 'rgba(255, 255, 255, 0.6)',
            darkGlass: 'rgba(0, 0, 0, 0.4)',
            accent: '#4f46e5',
          },
          boxShadow: {
            neomorphic: '10px 10px 20px #d1d9e6, -10px -10px 20px #ffffff',
            neomorphicDark: '10px 10px 20px #1c1c1e, -10px -10px 20px #2e2e30',
          },
          backdropBlur: {
            glass: '10px',
          },
          borderRadius: {
            glass: '1.5rem',
          },
        },
      },
    }
  </script>
</head>
<body class="bg-gray-100 light:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
  <div class="min-h-screen p-6">
    <!-- Header -->
    <header class="mb-6 flex justify-between items-center">
      <h1 class="text-3xl font-bold" id="dashboardTitle">Marketing Dashboard</h1>
      <div class="flex gap-4 items-center">
        <button id="notificationBtn" class="relative group">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405M19.6 13.6A8.963 8.963 0 0021 9a9 9 0 10-9 9 8.963 8.963 0 004.6-1.4L21 21z" />
          </svg>
          <span id="notificationCount" class="absolute top-0 right-0 inline-flex items-center justify-center px-1 py-0.5 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full">3</span>
          <div id="notificationDropdown" class="hidden absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 text-sm z-10">
            <p class="py-1 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer" onclick="dismissNotification(this)">New lead captured via Facebook Ads</p>
            <p class="py-1 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer" onclick="dismissNotification(this)">Revenue report updated</p>
            <p class="py-1 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer" onclick="dismissNotification(this)">Keyword ranking improved</p>
          </div>
        </button>
        <button id="themeToggle" class="px-4 py-2 rounded-xl shadow-md bg-white dark:bg-gray-800 dark:text-white transition-colors hover:bg-gray-200 dark:hover:bg-gray-700">
          Toggle Theme
        </button>
      </div>
    </header>

    <!-- Controls: Date Range and Metric Toggles -->
    <section class="mb-8 p-6 rounded-glass backdrop-blur-glass shadow-neomorphic dark:shadow-neomorphicDark bg-lightGlass dark:bg-darkGlass">
      <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
        <div class="flex gap-4">
          <select id="dateRange" class="px-3 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-sm">
            <option value="7days">Last 7 Days</option>
            <option value="30days">Last 30 Days</option>
            <option value="90days">Last 90 Days</option>
            <option value="custom">Custom</option>
          </select>
          <div id="customDateRange" class="hidden flex gap-2">
            <input type="date" id="startDate" class="px-3 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-sm" />
            <input type="date" id="endDate" class="px-3 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-sm" />
          </div>
        </div>
        <div class="flex gap-4 flex-wrap">
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric1" checked class="form-checkbox text-accent" />
            <span>Website Traffic</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric2" checked class="form-checkbox text-accent" />
            <span>Traffic Sources</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric3" checked class="form-checkbox text-accent" />
            <span>Conversion Rate</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric4" checked class="form-checkbox text-accent" />
            <span>Cost Per Acquisition</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric5" checked class="form-checkbox text-accent" />
            <span>Return on Ad Spend</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric6" checked class="form-checkbox text-accent" />
            <span>Click-Through Rate</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric7" checked class="form-checkbox text-accent" />
            <span>Social Media Engagement</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric8" checked class="form-checkbox text-accent" />
            <span>Email Open Rate</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric9" checked class="form-checkbox text-accent" />
            <span>Lead Generation</span>
          </label>
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox" id="toggleMetric10" checked class="form-checkbox text-accent" />
            <span>Keyword Rankings</span>
          </label>
        </div>
      </div>
    </section>

    <!-- Overview Cards -->
    <section id="overviewCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"></section>

    <!-- Main Charts -->
    <section id="mainCharts" class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"></section>

    <!-- Advanced Analytics -->
    <section id="advancedAnalytics" class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"></section>

    <!-- Table Data -->
    <section id="dataTable" class="p-6 rounded-glass backdrop-blur-glass shadow-neomorphic dark:shadow-neomorphicDark bg-lightGlass dark:bg-darkGlass">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold">Campaign Performance</h2>
        <input id="searchTable" type="text" placeholder="Search campaigns..." class="px-3 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-sm" />
      </div>
      <div class="overflow-x-auto">
        <table id="dynamicTable" class="min-w-full table-auto">
          <thead id="tableHead"></thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </section>

    <!-- Footer -->
    <footer class="mt-10 text-center text-sm text-gray-500 dark:text-gray-400">
      Â© 2025 Holistic Growth Marketing. All rights reserved.
    </footer>
  </div>

  <script>
    // Dashboard Configuration for Marketing Dashboard
    const dashboardConfig = {
      title: "Marketing Dashboard",
      metrics: [
        {
          id: "metric1",
          toggle: "toggleMetric1",
          card: {
            title: "Website Traffic",
            value: "125,670",
            change: "+12.3% MoM",
            changeClass: "text-green-500",
          },
          chart: {
            id: "trafficChart",
            title: "Website Traffic Trends",
            type: "line",
            data: {
              labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
              datasets: [{
                label: "Visitors",
                data: [80000, 85000, 90000, 100000, 110000, 125670],
                borderColor: "#4f46e5",
                backgroundColor: "rgba(79, 70, 229, 0.2)",
                fill: true,
                tension: 0.4,
              }],
            },
          },
        },
        {
          id: "metric2",
          toggle: "toggleMetric2",
          chart: {
            id: "sourcesChart",
            title: "Traffic Sources",
            type: "pie",
            data: {
              labels: ["Organic", "Paid", "Referral", "Social", "Direct"],
              datasets: [{
                data: [45, 25, 15, 10, 5],
                backgroundColor: ["#4f46e5", "#10b981", "#f59e0b", "#ef4444", "#8b5cf6"],
              }],
            },
          },
        },
        {
          id: "metric3",
          toggle: "toggleMetric3",
          card: {
            title: "Conversion Rate",
            value: "3.45%",
            change: "+0.5% MoM",
            changeClass: "text-green-500",
          },
          chart: {
            id: "conversionChart",
            title: "Conversion Rate Trends",
            type: "line",
            data: {
              labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
              datasets: [{
                label: "Conversion Rate (%)",
                data: [2.8, 3.0, 3.2, 3.3, 3.4, 3.45],
                borderColor: "#10b981",
                backgroundColor: "rgba(16, 185, 129, 0.2)",
                fill: true,
                tension: 0.4,
              }],
            },
          },
        },
        {
          id: "metric4",
          toggle: "toggleMetric4",
          card: {
            title: "Cost Per Acquisition",
            value: "$45.20",
            change: "-8.2% MoM",
            changeClass: "text-green-500",
          },
        },
        {
          id: "metric5",
          toggle: "toggleMetric5",
          card: {
            title: "Return on Ad Spend",
            value: "4.8x",
            change: "+15% MoM",
            changeClass: "text-green-500",
          },
        },
        {
          id: "metric6",
          toggle: "toggleMetric6",
          card: {
            title: "Click-Through Rate",
            value: "7.8%",
            change: "+1.2% MoM",
            changeClass: "text-green-500",
          },
        },
        {
          id: "metric7",
          toggle: "toggleMetric7",
          card: {
            title: "Social Media Engagement",
            value: "12,450",
            change: "+18.7% MoM",
            changeClass: "text-green-500",
          },
          chart: {
            id: "engagementChart",
            title: "Social Media Engagement Trends",
            type: "line",
            data: {
              labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
              datasets: [{
                label: "Engagements",
                data: [8000, 8500, 9000, 10000, 11000, 12450],
                borderColor: "#f59e0b",
                backgroundColor: "rgba(245, 158, 11, 0.2)",
                fill: true,
                tension: 0.4,
              }],
            },
          },
        },
        {
          id: "metric8",
          toggle: "toggleMetric8",
          card: {
            title: "Email Open Rate",
            value: "22.5%",
            change: "-2.1% MoM",
            changeClass: "text-red-500",
          },
          chart: {
            id: "emailChart",
            title: "Email Open Rate Trends",
            type: "line",
            data: {
              labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
              datasets: [{
                label: "Open Rate (%)",
                data: [25.0, 24.5, 23.8, 23.0, 22.8, 22.5],
                borderColor: "#ef4444",
                backgroundColor: "rgba(239, 68, 68, 0.2)",
                fill: true,
                tension: 0.4,
              }],
            },
          },
        },
        {
          id: "metric9",
          toggle: "toggleMetric9",
          card: {
            title: "Lead Generation",
            value: "1,230",
            change: "+10.5% MoM",
            changeClass: "text-green-500",
          },
          chart: {
            id: "leadsChart",
            title: "Lead Generation Trends",
            type: "line",
            data: {
              labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
              datasets: [{
                label: "Leads",
                data: [800, 850, 900, 1000, 1100, 1230],
                borderColor: "#8b5cf6",
                backgroundColor: "rgba(139, 92, 246, 0.2)",
                fill: true,
                tension: 0.4,
              }],
            },
          },
        },
        {
          id: "metric10",
          toggle: "toggleMetric10",
          chart: {
            id: "keywordChart",
            title: "Keyword Rankings",
            type: "bar",
            data: {
              labels: ["Keyword 1", "Keyword 2", "Keyword 3", "Keyword 4"],
              datasets: [{
                label: "Rank Position",
                data: [3, 7, 12, 5],
                backgroundColor: "#6b7280",
              }],
            },
          },
        },
      ],
      table: {
        headers: ["Campaign", "Impressions", "Clicks", "CTR", "Conversions"],
        rows: [
          ["Spring Promo", "22,540", "1,870", "8.3%", "210"],
          ["SEO Optimization", "15,300", "1,150", "7.5%", "190"],
          ["Email Campaign", "10,120", "930", "9.2%", "135"],
        ],
      },
    };

    // Debounce Utility
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Theme Toggle
    const themeToggle = document.getElementById('themeToggle');
    themeToggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
    });

    // Load saved theme
    if (localStorage.getItem('theme') === 'dark') {
      document.documentElement.classList.add('dark');
    }

    // Notification Dropdown
    const notificationBtn = document.getElementById('notificationBtn');
    const notificationDropdown = document.getElementById('notificationDropdown');
    notificationBtn.addEventListener('click', () => {
      notificationDropdown.classList.toggle('hidden');
    });

    function dismissNotification(element) {
      element.remove();
      const count = document.getElementById('notificationCount');
      const currentCount = parseInt(count.textContent) - 1;
      count.textContent = currentCount;
      if (currentCount === 0) count.classList.add('hidden');
    }

    // Render Dashboard
    function renderDashboard() {
      document.getElementById('dashboardTitle').textContent = dashboardConfig.title;

      // Render Overview Cards
      const overviewCards = document.getElementById('overviewCards');
      overviewCards.innerHTML = '';
      dashboardConfig.metrics.forEach(metric => {
        if (metric.card && document.getElementById(metric.toggle).checked) {
          const card = document.createElement('div');
          card.className = 'p-6 rounded-glass backdrop-blur-glass shadow-neomorphic dark:shadow-neomorphicDark bg-lightGlass dark:bg-darkGlass hover:scale-105 transition-transform duration-200';
          card.innerHTML = `
            <h2 class="text-lg font-semibold">${metric.card.title}</h2>
            <p class="text-2xl font-bold mt-2">${metric.card.value}</p>
            <span class="text-sm ${metric.card.changeClass}">${metric.card.change}</span>
          `;
          overviewCards.appendChild(card);
        }
      });

      // Render Charts
      const mainCharts = document.getElementById('mainCharts');
      const advancedAnalytics = document.getElementById('advancedAnalytics');
      mainCharts.innerHTML = '';
      advancedAnalytics.innerHTML = '';
      dashboardConfig.metrics.forEach(metric => {
        if (metric.chart && document.getElementById(metric.toggle).checked) {
          const chartDiv = document.createElement('div');
          chartDiv.className = `p-6 rounded-glass backdrop-blur-glass shadow-neomorphic dark:shadow-neomorphicDark bg-lightGlass dark:bg-darkGlass h-80`;
          chartDiv.innerHTML = `
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-lg font-semibold">${metric.chart.title}</h2>
              <select class="chart-type-toggle px-2 py-1 rounded-md bg-gray-200 dark:bg-gray-700 text-sm" data-chart-id="${metric.chart.id}">
                <option value="line" ${metric.chart.type === 'line' ? 'selected' : ''}>Line</option>
                <option value="bar" ${metric.chart.type === 'bar' ? 'selected' : ''}>Bar</option>
                <option value="pie" ${metric.chart.type === 'pie' ? 'selected' : ''}>Pie</option>
              </select>
            </div>
            <div class="h-64">
              <canvas id="${metric.chart.id}" style="height: 256px;"></canvas>
            </div>
          `;
          if (metric.chart.type === 'pie') {
            advancedAnalytics.appendChild(chartDiv);
          } else {
            mainCharts.appendChild(chartDiv);
          }
        }
      });

      // Render Table
      const tableHead = document.getElementById('tableHead');
      const tableBody = document.getElementById('tableBody');
      tableHead.innerHTML = '<tr class="text-left border-b border-gray-300 dark:border-gray-600">' + 
        dashboardConfig.table.headers.map(header => `<th class="py-2">${header}</th>`).join('') + '</tr>';
      tableBody.innerHTML = dashboardConfig.table.rows.map(row => 
        `<tr>${row.map(cell => `<td class="py-2">${cell}</td>`).join('')}</tr>`
      ).join('');
    }

    // Lazy Load Charts
    const charts = {};
    function initializeCharts() {
      const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const canvas = entry.target;
            const metric = dashboardConfig.metrics.find(m => m.chart && m.chart.id === canvas.id);
            if (metric && !canvas.dataset.chartInitialized) {
              charts[canvas.id] = new Chart(canvas.getContext('2d'), {
                type: metric.chart.type,
                data: metric.chart.data,
                options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  scales: metric.chart.type !== 'pie' ? { y: { beginAtZero: true } } : {},
                  animation: { duration: 500 },
                },
              });
              canvas.dataset.chartInitialized = 'true';
              observer.unobserve(canvas);
              canvas.dispatchEvent(new Event('chartInitialized'));
            }
          }
        });
      }, { threshold: 0.1 });

      dashboardConfig.metrics.forEach(metric => {
        if (metric.chart && document.getElementById(metric.toggle).checked) {
          const canvas = document.getElementById(metric.chart.id);
          if (canvas) observer.observe(canvas);
        }
      });
    }

    // Date Range Filtering (Mock)
    function applyDateFilter() {
      const range = document.getElementById('dateRange').value;
      let startDate, endDate;
      const today = new Date();
      if (range === '7days') {
        startDate = new Date(today.setDate(today.getDate() - 7));
        endDate = new Date();
      } else if (range === '30days') {
        startDate = new Date(today.setDate(today.getDate() - 30));
        endDate = new Date();
      } else if (range === '90days') {
        startDate = new Date(today.setDate(today.getDate() - 90));
        endDate = new Date();
      } else {
        startDate = new Date(document.getElementById('startDate').value);
        endDate = new Date(document.getElementById('endDate').value);
      }
      // Mock data update (replace with actual API call or data filtering)
      dashboardConfig.metrics.forEach(metric => {
        if (metric.chart) {
          metric.chart.data.labels = ["Filtered Data"];
          metric.chart.data.datasets[0].data = [Math.floor(Math.random() * 100000)];
          if (charts[metric.chart.id]) {
            charts[metric.chart.id].data = metric.chart.data;
            charts[metric.chart.id].update();
          }
        }
      });
      renderDashboard();
      initializeCharts();
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', () => {
      renderDashboard();
      initializeCharts();

      // Metric Toggles
      dashboardConfig.metrics.forEach(metric => {
        const toggle = document.getElementById(metric.toggle);
        toggle.addEventListener('change', () => {
          renderDashboard();
          initializeCharts();
        });
      });

      // Chart Type Toggles
      document.querySelectorAll('.chart-type-toggle').forEach(select => {
        select.addEventListener('change', (e) => {
          const chartId = e.target.dataset.chartId;
          const metric = dashboardConfig.metrics.find(m => m.chart && m.chart.id === chartId);
          if (metric && charts[chartId]) {
            metric.chart.type = e.target.value;
            charts[chartId].destroy();
            const canvas = document.getElementById(chartId);
            canvas.dataset.chartInitialized = 'false';
            charts[chartId] = new Chart(canvas.getContext('2d'), {
              type: metric.chart.type,
              data: metric.chart.data,
              options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: metric.chart.type !== 'pie' ? { y: { beginAtZero: true } } : {},
                animation: { duration: 500 },
              },
            });
            canvas.dataset.chartInitialized = 'true';
          }
        });
      });

      // Date Range
      const dateRange = document.getElementById('dateRange');
      const customDateRange = document.getElementById('customDateRange');
      dateRange.addEventListener('change', () => {
        customDateRange.classList.toggle('hidden', dateRange.value !== 'custom');
        applyDateFilter();
      });
      document.getElementById('startDate')?.addEventListener('change', applyDateFilter);
      document.getElementById('endDate')?.addEventListener('change', applyDateFilter);

      // Table Search
      const searchTable = document.getElementById('searchTable');
      const debouncedSearch = debounce((e) => {
        const searchTerm = e.target.value.toLowerCase();
        const rows = document.querySelectorAll('#tableBody tr');
        rows.forEach(row => {
          const cells = Array.from(row.cells).map(cell => cell.textContent.toLowerCase());
          row.style.display = cells.some(cell => cell.includes(searchTerm)) ? '' : 'none';
        });
      }, 300);
      searchTable.addEventListener('input', debouncedSearch);
    });
  </script>
